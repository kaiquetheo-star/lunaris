/* =========================================================================
   LUNARIS ECHOES - CORE STYLE (v3.0 Final)
   Arquitetura: Single Spritesheet + Mobile First
   ========================================================================= */

:root {
  /* DIMENSÕES MATEMÁTICAS DO SPRITE (Não altere a menos que o PNG mude) */
  --frame-size: 455px;       /* Tamanho de 1 quadro (altura e largura) */
  --sheet-cols: 6;           /* Quantos quadros na horizontal */
  
  /* Largura total da imagem = 455 * 6 = 2730px */
  --sheet-width: calc(var(--frame-size) * var(--sheet-cols));
  
  /* CORES DO TEMA NEON */
  --neon-pink: #ff006e;
  --neon-blue: #00ffff;
  --neon-purple: #bd00ff;
  --bg-dark: #0a0010;
}

/* Reset Global */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }

body, html {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100dvh; /* Dynamic Viewport Height para celulares */
  background: var(--bg-dark);
  overflow: hidden;
  font-family: 'Segoe UI', sans-serif;
}

/* =========================================================================
   1. CAMADAS DO JOGO (LAYER SYSTEM)
   Ordem de Z-Index é CRUCIAL para os cliques funcionarem
   ========================================================================= */

#game-container {
  position: relative;
  width: 100%;
  height: 100%;
}

/* CAMADA 1: Fundo do Quarto */
#bg-room {
  position: absolute;
  inset: 0;
  z-index: 1;
  background: url('quarto_bg.png') center/cover no-repeat;
}

/* CAMADA 2: Chuva (Na Janela) */
#rain-layer {
  position: absolute;
  /* Ajuste estes % para encaixar na janela do seu desenho */
  top: 15%; 
  left: 10%; 
  width: 35%; 
  height: 45%;
  overflow: hidden;
  border-radius: 5px;
  z-index: 2;
  pointer-events: none; /* Deixa o clique passar para o fundo */
  opacity: 0.6;
}

/* CAMADA 3: O Gato (Sprite) */
#lunaris-sprite {
  position: absolute;
  z-index: 10; /* Gato acima do fundo e chuva */
  
  /* Posição no Quarto */
  bottom: 20%;
  left: 15%;
  
  /* Tamanho da Caixa de Exibição (Viewport do Sprite) */
  width: var(--frame-size);
  height: var(--frame-size);
  
  /* Configuração da Imagem */
  background-image: url('spritesheet.png'); /* SEU ARQUIVO ÚNICO DO FIGMA */
  background-repeat: no-repeat;
  
  /* A largura do background deve ser a largura total da tira */
  background-size: var(--sheet-width) auto; 
  
  /* Renderização e Transformação */
  image-rendering: pixelated; 
  transition: none !important; /* IMPORTANTE: Remove deslize suave */
  transform-origin: bottom left;
  transform: scale(0.6); /* Ajuste visual inicial para PC */
  cursor: pointer;
  filter: drop-shadow(0 0 15px rgba(255, 0, 110, 0.4));
}

/* CAMADA 4: Objetos Interativos e Luz */
#hitboxes-layer {
  position: absolute;
  inset: 0;
  z-index: 20;
  pointer-events: none; /* Container invisível não bloqueia cliques */
}
/* Os filhos (botões invisíveis) devem receber cliques */
#hitboxes-layer > div, #switch-hitbox { 
  pointer-events: auto; 
  cursor: pointer; 
}

/* Interruptor de Luz (Posicione sobre o desenho) */
#switch-hitbox {
  position: absolute;
  top: 40%;
  left: 2%;
  width: 50px;
  height: 70px;
  z-index: 50; /* Sempre no topo do cenário */
}

/* Livro (Diário) */
#book-hitbox {
  position: absolute;
  bottom: 25%;
  right: 15%;
  width: 80px;
  height: 60px;
  /* background: rgba(255,0,0,0.2); Deixe transparente depois de ajustar */
}

/* CAMADA 5: Escuridão (Luz Apagada) */
#room-darkness-overlay {
  position: absolute;
  inset: 0;
  background: #000;
  opacity: 0;
  pointer-events: none; /* Clicks passam através do escuro */
  transition: opacity 0.8s ease;
  z-index: 25; /* Cobre o gato, mas fica abaixo da UI */
}
/* Quando a classe .lights-out é ativada pelo JS */
#game-container.lights-out #room-darkness-overlay {
  opacity: 0.85;
}

/* CAMADA 6: Interface de Usuário (UI) */
#ui-layer {
  position: absolute;
  inset: 0;
  z-index: 100;
  pointer-events: none; /* UI container deixa clicar no jogo */
}
/* Elementos da UI recebem clique */
#ui-layer > * { pointer-events: auto; }

/* =========================================================================
   2. ANIMAÇÃO DO GATO (SPRITE ENGINE)
   ========================================================================= */

/* Animação Horizontal (Corre a fita do Frame 1 ao 6) */
@keyframes playSpriteRow {
  from { background-position-x: 0px; }
  to   { background-position-x: calc(var(--sheet-width) * -1); }
}

/* -- ESTADOS (Controlam a linha Vertical Y) -- */
/* Ajuste os multiplicadores (* -0, * -1) conforme a ordem no seu PNG do Figma */

/* LINHA 1: IDLE */
.state-idle {
  background-position-y: 0px; 
  animation: playSpriteRow 1.5s steps(6) infinite;
}

/* LINHA 2: SLEEP */
.state-sleep {
  background-position-y: calc(var(--frame-size) * -1); 
  animation: playSpriteRow 2s steps(6) infinite;
}

/* LINHA 3: EAT */
.state-eat {
  background-position-y: calc(var(--frame-size) * -2); 
  animation: playSpriteRow 1s steps(6) infinite;
}

/* LINHA 4: LICK */
.state-lick {
  background-position-y: calc(var(--frame-size) * -3); 
  animation: playSpriteRow 1.2s steps(6) infinite;
}

/* LINHA 5: STRETCH */
.state-stretch {
  background-position-y: calc(var(--frame-size) * -4); 
  animation: playSpriteRow 1.2s steps(6) infinite;
}

/* LINHA 6: WALK / VIBE */
.state-vibe {
  background-position-y: calc(var(--frame-size) * -5); 
  animation: playSpriteRow 1.2s steps(6) infinite;
}

/* =========================================================================
   3. ESTILOS DA INTERFACE (UI)
   ========================================================================= */

/* Barras de Status */
.status-container {
  position: absolute;
  top: 20px;
  left: 20px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.stat-row { display: flex; align-items: center; gap: 10px; }
.stat-label { 
  color: #fff; font-size: 10px; font-weight: bold; width: 40px; text-transform: uppercase; text-shadow: 0 0 5px var(--neon-pink);
}

.bar-bg {
  width: 150px; height: 10px; background: rgba(0,0,0,0.6);
  border: 1px solid var(--neon-purple); border-radius: 5px; overflow: hidden;
}

.bar { height: 100%; transition: width 0.5s ease; }
#hunger-bar { background: #ffe600; box-shadow: 0 0 8px #ffe600; }
#vibe-bar   { background: var(--neon-pink); box-shadow: 0 0 8px var(--neon-pink); }
#sleep-bar  { background: var(--neon-blue); box-shadow: 0 0 8px var(--neon-blue); }

/* Moedas */
#coins-display {
  position: absolute;
  top: 20px; right: 20px;
  background: rgba(0,0,0,0.7);
  padding: 8px 15px;
  border-radius: 20px;
  border: 1px solid var(--neon-blue);
  color: var(--neon-blue);
  font-weight: bold;
  font-size: 18px;
  text-shadow: 0 0 5px var(--neon-blue);
}

/* Dock Inferior (Controles) */
#bottom-dock {
  position: absolute;
  bottom: 5%;
  left: 0; 
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: flex-end;
  gap: 15px;
  padding: 0 20px;
  pointer-events: none; /* Garante que a área vazia não bloqueie o jogo */
}
#bottom-dock > * { pointer-events: auto; } /* Botões clicáveis */

/* Mixer de Som */
#mixer-dock {
  background: rgba(10, 0, 20, 0.9);
  border: 1px solid var(--neon-pink);
  border-radius: 15px;
  padding: 10px;
  display: flex;
  flex-direction: column;
  gap: 5px;
}
.mixer-control { color: white; font-size: 12px; display: flex; align-items: center; gap: 5px; }
input[type=range] { accent-color: var(--neon-pink); cursor: pointer; }

/* Botões Principais */
.game-btn {
  padding: 12px 25px;
  border: none;
  border-radius: 12px;
  color: white;
  font-weight: bold;
  font-size: 14px;
  cursor: pointer;
  transition: transform 0.1s;
  text-transform: uppercase;
  letter-spacing: 1px;
}
.game-btn:active { transform: scale(0.95); }

#santuario-btn {
  background: linear-gradient(135deg, #00ff9d, #008055);
  box-shadow: 0 0 15px #00ff9d;
  color: #002b15;
}

#sleep-btn {
  background: linear-gradient(135deg, #7b00ff, #3c0080);
  box-shadow: 0 0 15px #7b00ff;
}

/* =========================================================================
   4. MODAIS E SPLASH SCREEN
   ========================================================================= */

/* Tela Inicial */
#splash {
  position: fixed; inset: 0; z-index: 9999;
  background: var(--bg-dark);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  transition: opacity 0.5s;
}
#logo { width: 280px; margin-bottom: 30px; animation: pulse 2s infinite; }
#start-btn {
  padding: 15px 50px; background: var(--neon-pink); color: white;
  border: none; border-radius: 50px; font-size: 20px; font-weight: bold;
  cursor: pointer; box-shadow: 0 0 20px var(--neon-pink);
}

/* Modais (Loja/Diário) */
#modal-overlay {
  position: fixed; inset: 0; z-index: 5000;
  background: rgba(0,0,0,0.85);
  display: flex; justify-content: center; align-items: center;
  opacity: 1; transition: opacity 0.3s;
}
#modal-overlay.hidden { opacity: 0; pointer-events: none; }

#modal-content {
  background: #150020;
  width: 90%; max-width: 450px; max-height: 80vh;
  overflow-y: auto;
  border: 2px solid var(--neon-purple);
  border-radius: 20px;
  padding: 25px;
  color: white;
  position: relative;
  box-shadow: 0 0 30px rgba(189, 0, 255, 0.3);
}

.shop-item {
  display: flex; justify-content: space-between; align-items: center;
  padding: 15px; margin-bottom: 10px;
  background: rgba(255,255,255,0.05); border-radius: 10px;
  border-left: 3px solid var(--neon-blue);
}
.shop-item button {
  background: var(--neon-blue); border: none; padding: 8px 12px;
  border-radius: 5px; cursor: pointer; font-weight: bold; color: #000;
}

#close-modal {
  position: absolute; top: 15px; right: 15px;
  background: var(--neon-pink); color: white; border: none;
  width: 30px; height: 30px; border-radius: 50%; cursor: pointer;
}

/* =========================================================================
   5. RESPONSIVIDADE MOBILE
   ========================================================================= */

@media (max-width: 600px) {
  /* Encolhe o gato para caber na tela pequena */
  #lunaris-sprite {
    transform: scale(0.45); /* Reduz para 45% do tamanho original */
    bottom: 15%;
    left: 5%;
  }

  /* Ajusta UI */
  .status-container { transform: scale(0.85); transform-origin: top left; }
  #coins-display { transform: scale(0.85); transform-origin: top right; }

  /* Ajusta Dock Inferior */
  #bottom-dock {
    flex-wrap: wrap;
    gap: 10px;
    bottom: 2%;
  }
  #mixer-dock { display: none; /* Opcional: Esconder mixer no mobile se ficar apertado */ }
  
  .game-btn { padding: 10px 20px; font-size: 12px; }
}

/* Animações Genéricas */
@keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.8; transform: scale(0.98); } }
@keyframes fall { 0% { transform: translateY(-100px); } 100% { transform: translateY(100vh); } }
.rain-drop { position: absolute; width: 2px; height: 15px; background: rgba(255,255,255,0.4); animation: fall linear infinite; }